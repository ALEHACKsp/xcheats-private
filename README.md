Made public. Trash source. Enjoy. Total one spend: 35 minutes excluding offset updates. 

Warning: reading this code might cause brain cancer. Keeping here for historical purposes. 
